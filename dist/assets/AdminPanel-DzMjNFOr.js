import{j as e,B as L,i as Q,s as q,g as X,u as Z,f as O}from"./index-KtrVGIDC.js";import{r as u}from"./router-CF4w8fas.js";import{g as Y,u as ee}from"./orderService-BNVRGs-a.js";import{g as se}from"./userService-CeeJh1aS.js";import{R as te,B as ae,C as le,X as ne,Y as re,T as ie,a as oe,b as ce}from"./charts-DZsPsesR.js";import"./state-CToor5Tf.js";const de=()=>{const[a,g]=u.useState([]),[w,N]=u.useState(!1),[s,i]=u.useState({code:"",discountType:"percentage",discountValue:0,minPurchase:0,maxDiscount:0,expiresAt:"",usageLimit:0}),b=l=>{l.preventDefault();const f={id:Date.now().toString(),code:s.code.toUpperCase(),discountType:s.discountType,discountValue:s.discountValue,minPurchase:s.minPurchase||void 0,maxDiscount:s.maxDiscount||void 0,expiresAt:s.expiresAt?new Date(s.expiresAt):void 0,usageLimit:s.usageLimit||void 0,usedCount:0,isActive:!0,createdAt:new Date};g([...a,f]),N(!1),i({code:"",discountType:"percentage",discountValue:0,minPurchase:0,maxDiscount:0,expiresAt:"",usageLimit:0})},c=l=>{g(a.map(f=>f.id===l?{...f,isActive:!f.isActive}:f))},x=l=>{confirm("Â¿Seguro que quieres eliminar este cupÃ³n?")&&g(a.filter(f=>f.id!==l))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-black",children:"GestiÃ³n de Cupones"}),e.jsx(L,{onClick:()=>N(!w),children:w?"Cancelar":"+ Nuevo CupÃ³n"})]}),w&&e.jsxs("form",{onSubmit:b,className:"bg-white p-6 rounded-xl border-2 border-gold-500 space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:S.label,children:"CÃ³digo del CupÃ³n"}),e.jsx("input",{type:"text",value:s.code,onChange:l=>i({...s,code:l.target.value}),placeholder:"VERANO2026",required:!0,className:S.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:S.label,children:"Tipo de Descuento"}),e.jsxs("select",{value:s.discountType,onChange:l=>i({...s,discountType:l.target.value}),className:S.input,children:[e.jsx("option",{value:"percentage",children:"Porcentaje (%)"}),e.jsx("option",{value:"fixed",children:"Monto Fijo (S/)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:S.label,children:["Valor del Descuento ",s.discountType==="percentage"?"(%)":"(S/)"]}),e.jsx("input",{type:"number",value:s.discountValue,onChange:l=>i({...s,discountValue:Number(l.target.value)}),min:"0",step:"0.01",required:!0,className:S.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:S.label,children:"Compra MÃ­nima (S/) - Opcional"}),e.jsx("input",{type:"number",value:s.minPurchase,onChange:l=>i({...s,minPurchase:Number(l.target.value)}),min:"0",step:"0.01",className:S.input})]}),s.discountType==="percentage"&&e.jsxs("div",{children:[e.jsx("label",{className:S.label,children:"Descuento MÃ¡ximo (S/) - Opcional"}),e.jsx("input",{type:"number",value:s.maxDiscount,onChange:l=>i({...s,maxDiscount:Number(l.target.value)}),min:"0",step:"0.01",className:S.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:S.label,children:"Fecha de ExpiraciÃ³n - Opcional"}),e.jsx("input",{type:"datetime-local",value:s.expiresAt,onChange:l=>i({...s,expiresAt:l.target.value}),className:S.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:S.label,children:"LÃ­mite de Usos - Opcional"}),e.jsx("input",{type:"number",value:s.usageLimit,onChange:l=>i({...s,usageLimit:Number(l.target.value)}),min:"0",className:S.input})]})]}),e.jsx(L,{type:"submit",className:"w-full",children:"Crear CupÃ³n"})]}),e.jsx("div",{className:"grid gap-4",children:a.length===0?e.jsx("div",{className:"text-center py-12 bg-stone-50 rounded-xl",children:e.jsx("p",{className:"text-stone-500",children:"No hay cupones creados aÃºn"})}):a.map(l=>e.jsx("div",{className:`${S.couponCard} ${!l.isActive&&"opacity-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:S.couponCode,children:l.code}),e.jsx("span",{className:`${S.badge} ${l.isActive?"bg-green-100 text-green-800":"bg-stone-100 text-stone-600"}`,children:l.isActive?"Activo":"Inactivo"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-2 text-sm",children:[e.jsxs("p",{className:"text-stone-700",children:[e.jsx("strong",{children:"Descuento:"})," ",l.discountType==="percentage"?`${l.discountValue}%`:`S/ ${l.discountValue}`]}),l.minPurchase&&e.jsxs("p",{className:"text-stone-700",children:[e.jsx("strong",{children:"Compra mÃ­nima:"})," S/ ",l.minPurchase]}),l.expiresAt&&e.jsxs("p",{className:"text-stone-700",children:[e.jsx("strong",{children:"Expira:"})," ",new Date(l.expiresAt).toLocaleDateString()]}),e.jsxs("p",{className:"text-stone-700",children:[e.jsx("strong",{children:"Usos:"})," ",l.usedCount,l.usageLimit&&` / ${l.usageLimit}`]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c(l.id),className:S.actionButton,title:l.isActive?"Desactivar":"Activar",children:l.isActive?"ðŸ”’":"ðŸ”“"}),e.jsx("button",{onClick:()=>x(l.id),className:`${S.actionButton} hover:bg-red-50`,title:"Eliminar",children:"ðŸ—‘ï¸"})]})]})},l.id))})]})},S={label:"block text-sm font-bold text-stone-900 mb-1",input:"w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-gold-500 outline-none",couponCard:"bg-white p-4 rounded-xl border border-stone-200 hover:shadow-md transition-shadow",couponCode:"text-xl font-bold text-gold-700 bg-gold-50 px-3 py-1 rounded-lg",badge:"px-2 py-1 rounded text-xs font-bold",actionButton:"p-2 hover:bg-stone-100 rounded-lg transition-colors"},J=a=>({productId:a.product_id,stock:a.stock,reserved:a.reserved,lowStockThreshold:a.low_stock_threshold,lastUpdated:new Date(a.updated_at)}),xe=async()=>{if(!Q()||!q)return[];const{data:a,error:g}=await q.from("inventory").select("*").order("updated_at",{ascending:!1});return g?[]:(a||[]).map(J)},K=async(a,g)=>{if(!Q()||!q)return null;const{data:w}=await q.from("inventory").select("id").eq("product_id",a).single();if(w){const{data:N,error:s}=await q.from("inventory").update({stock:g,updated_at:new Date().toISOString()}).eq("product_id",a).select().single();return s?null:N?J(N):null}else{const{data:N,error:s}=await q.from("inventory").insert({product_id:a,stock:g}).select().single();return s?null:N?J(N):null}},W=a=>{if(a.length===0)return[{}];const[g,...w]=a,N=W(w),s=[];return g.values.forEach(i=>{N.forEach(b=>{s.push({[g.name]:i,...b})})}),s},me=a=>Object.entries(a).map(([g,w])=>`${g}: ${w}`).join(" | "),H=({product:a,initialInventory:g,initialVariantTypes:w=[],initialVariantInventory:N=[],onSave:s,onClose:i})=>{const b=!!a,[c,x]=u.useState({name:a?.name||"",description:a?.description||"",price:a?.price||0,category:a?.category||"General",imageUrl:a?.imageUrl||"",brand:a?.brand||"",lowStockThreshold:g?.lowStockThreshold||10,isFeatured:a?.isFeatured||!1}),[l,f]=u.useState(a?.images||[]),[n,k]=u.useState(""),[o,D]=u.useState(""),[y,d]=u.useState(w),[v,$]=u.useState(""),[I,F]=u.useState(N),B=u.useMemo(()=>W(y),[y]),M=u.useMemo(()=>I.reduce((t,p)=>t+p.stock,0),[I]),R=()=>{if(!v.trim())return;const t={id:Date.now().toString(),name:v.trim(),values:[]};d([...y,t]),$("")},_=t=>{d(y.filter(m=>m.id!==t));const p=y.find(m=>m.id===t);p&&F(I.filter(m=>!Object.keys(m.variantCombination).includes(p.name)))},G=(t,p)=>{p.trim()&&d(y.map(m=>m.id===t?{...m,values:[...m.values,p.trim()]}:m))},r=(t,p)=>{d(y.map(m=>m.id===t?{...m,values:m.values.filter(T=>T!==p)}:m))},j=t=>I.find(m=>JSON.stringify(m.variantCombination)===JSON.stringify(t))?.stock||0,A=(t,p)=>{const m=I.findIndex(T=>JSON.stringify(T.variantCombination)===JSON.stringify(t));if(m>=0){const T=[...I];T[m]={...T[m],stock:p},F(T)}else F([...I,{id:Date.now().toString(),productId:a.id,variantCombination:t,stock:p,reserved:0}])},P=t=>{t.preventDefault(),(()=>{const m={id:a?.id||crypto.randomUUID(),name:c.name,description:c.description,price:Number(c.price),category:c.category,imageUrl:c.imageUrl||l.find(V=>V.isPrimary)?.url||l[0]?.url||"",images:l,brand:c.brand||void 0,sizes:y.find(V=>V.name==="Talla")?.values||[],colors:y.find(V=>V.name==="Color")?.values||[],isFeatured:c.isFeatured},T={productId:m.id,stock:M>0?M:0,reserved:g?.reserved||0,lowStockThreshold:Number(c.lowStockThreshold),lastUpdated:new Date};s(m,T,y,I)})()};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:i,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-stone-200 p-6 flex items-center justify-between z-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-black border-l-4 border-gold-500 pl-4",children:b?"Editar Producto":"Nuevo Producto"}),e.jsx("button",{onClick:i,className:"text-stone-400 hover:text-black transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 flex gap-4",children:[e.jsx("img",{src:c.imageUrl,alt:c.name,className:"w-24 h-24 rounded-lg object-cover border"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:h.label,children:"URL de Imagen"}),e.jsx("input",{type:"url",value:c.imageUrl,onChange:t=>x({...c,imageUrl:t.target.value}),className:h.input,required:!0})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:h.label,children:"Nombre del Producto"}),e.jsx("input",{type:"text",value:c.name,onChange:t=>x({...c,name:t.target.value}),className:h.input,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:h.label,children:"CategorÃ­a"}),e.jsxs("select",{value:c.category,onChange:t=>x({...c,category:t.target.value}),className:h.input,children:[e.jsx("option",{value:"Ropa",children:"Ropa"}),e.jsx("option",{value:"Calzado",children:"Calzado"}),e.jsx("option",{value:"Accesorios",children:"Accesorios"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:h.label,children:"Precio (S/)"}),e.jsx("input",{type:"number",value:c.price,onChange:t=>x({...c,price:Number(t.target.value)}),className:h.input,step:"0.01",min:"0",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:h.label,children:"DescripciÃ³n"}),e.jsx("textarea",{value:c.description,onChange:t=>x({...c,description:t.target.value}),className:h.input,rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:h.label,children:"Marca"}),e.jsx("input",{type:"text",value:c.brand,onChange:t=>x({...c,brand:t.target.value}),className:h.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:h.label,children:"Umbral Stock Bajo"}),e.jsx("input",{type:"number",value:c.lowStockThreshold,onChange:t=>x({...c,lowStockThreshold:Number(t.target.value)}),className:h.input,min:"0"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.isFeatured,onChange:t=>x({...c,isFeatured:t.target.checked}),className:"w-4 h-4 accent-gold-500 cursor-pointer"}),e.jsx("span",{className:h.label,children:"â­ Destacar en pÃ¡gina principal"})]}),e.jsx("p",{className:"text-xs text-stone-500 mt-1 ml-6",children:"Los productos destacados aparecen en el carrusel de la landing page"})]})]}),e.jsxs("div",{className:"border-t border-stone-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-black mb-4",children:"ðŸ–¼ï¸ GalerÃ­a de ImÃ¡genes"}),l.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:l.map((t,p)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:t.url,alt:`Image ${p+1}`,className:"w-full h-32 object-cover rounded-lg border-2 border-stone-200"}),e.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{const m=[...l];m[p]={...m[p],isPrimary:!0},m.forEach((T,V)=>{V!==p&&(T.isPrimary=!1)}),f(m)},className:"px-2 py-1 bg-gold-500 text-black rounded text-xs font-bold hover:bg-gold-600",title:"Marcar como principal",children:t.isPrimary?"â­":"â˜†"}),e.jsx("button",{type:"button",onClick:()=>f(l.filter((m,T)=>T!==p)),className:"px-2 py-1 bg-red-500 text-white rounded text-xs font-bold hover:bg-red-600",children:"ðŸ—‘ï¸"})]}),t.color&&e.jsx("span",{className:"absolute top-2 left-2 px-2 py-1 bg-black/70 text-white text-xs rounded",children:t.color}),t.isPrimary&&e.jsx("span",{className:"absolute top-2 right-2 text-gold-400 text-lg",children:"â­"})]},p))}),e.jsxs("div",{className:"bg-stone-50 p-4 rounded-lg",children:[e.jsx("label",{className:h.label,children:"Agregar Nueva Imagen"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"url",value:n,onChange:t=>k(t.target.value),placeholder:"URL de la imagen",className:h.input}),e.jsxs("select",{value:o,onChange:t=>D(t.target.value),className:h.input+" w-48",children:[e.jsx("option",{value:"",children:"Sin color"}),y.find(t=>t.name.toLowerCase()==="color")?.values.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx(L,{type:"button",onClick:()=>{if(!n.trim())return;const t={url:n.trim(),color:o||void 0,isPrimary:l.length===0,order:l.length};f([...l,t]),k(""),D("")},children:"+ Agregar"})]}),e.jsx("p",{className:"text-xs text-stone-500",children:"ðŸ’¡ Asocia imÃ¡genes a colores para que cambien automÃ¡ticamente al seleccionar variantes"})]})]}),e.jsxs("div",{className:"border-t border-stone-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-black mb-4",children:"ðŸ“¦ Variantes Personalizadas"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:v,onChange:t=>$(t.target.value),placeholder:"Nueva variante (ej: Material, Estilo...)",className:h.input,onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),R())}),e.jsx(L,{type:"button",onClick:R,children:"+ Agregar"})]}),e.jsx("div",{className:"space-y-4",children:y.map(t=>e.jsxs("div",{className:"bg-stone-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-bold text-black",children:t.name}),e.jsx("button",{type:"button",onClick:()=>_(t.id),className:"text-red-500 hover:text-red-700 text-sm font-bold",children:"Eliminar"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:t.values.map(p=>e.jsxs("span",{className:"px-3 py-1 bg-gold-100 text-black rounded-full text-sm font-medium flex items-center gap-1",children:[p,e.jsx("button",{type:"button",onClick:()=>r(t.id,p),className:"ml-1 text-stone-500 hover:text-red-500",children:"Ã—"})]},p))}),e.jsx("input",{type:"text",placeholder:`Agregar valor a ${t.name}...`,className:"w-full px-3 py-1 border border-stone-300 rounded text-sm",onKeyPress:p=>{p.key==="Enter"&&(p.preventDefault(),G(t.id,p.target.value),p.target.value="")}})]},t.id))})]}),B.length>1?e.jsxs("div",{className:"border-t border-stone-200 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-black",children:"ðŸ§® Inventario por Variante"}),e.jsxs("div",{className:"bg-gold-100 px-4 py-2 rounded-lg",children:[e.jsx("span",{className:"text-sm text-stone-700",children:"Stock Total: "}),e.jsx("span",{className:"text-xl font-bold text-gold-700",children:M})]})]}),e.jsx("div",{className:"bg-stone-50 rounded-lg overflow-hidden max-h-64 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-stone-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left font-bold text-stone-700",children:"CombinaciÃ³n"}),e.jsx("th",{className:"px-4 py-2 text-center font-bold text-stone-700 w-32",children:"Stock"})]})}),e.jsx("tbody",{children:B.map((t,p)=>e.jsxs("tr",{className:"border-t border-stone-200 hover:bg-stone-100",children:[e.jsx("td",{className:"px-4 py-2 font-medium",children:me(t)}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"number",value:j(t),onChange:m=>A(t,Number(m.target.value)),className:"w-full px-2 py-1 border border-stone-300 rounded text-center",min:"0"})})]},p))})]})}),e.jsxs("p",{className:"text-xs text-stone-500 mt-2",children:["ðŸ’¡ ",B.length," combinaciones posibles. El stock total se calcula automÃ¡ticamente."]})]}):e.jsxs("div",{className:"border-t border-stone-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-black mb-4",children:"ðŸ“¦ Inventario"}),e.jsxs("div",{className:"bg-stone-50 p-4 rounded-lg",children:[e.jsx("label",{className:h.label,children:"Stock Disponible"}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("input",{type:"number",value:j({}),onChange:t=>A({},Number(t.target.value)),className:h.input+" text-lg font-bold w-32",min:"0"}),e.jsx("span",{className:"text-sm text-stone-500",children:"unidades disponibles para venta inmediata."})]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end border-t border-stone-200 pt-6",children:[e.jsx("button",{type:"button",onClick:i,className:"px-6 py-2 bg-stone-200 text-black font-bold rounded-lg hover:bg-stone-300",children:"Cancelar"}),e.jsx(L,{type:"submit",children:"Guardar Cambios"})]})]})]})})},ue=()=>{const[a,g]=u.useState([]),[w,N]=u.useState(!0),[s,i]=u.useState([]),[b,c]=u.useState({}),[x,l]=u.useState({}),[f,n]=u.useState(null),[k,o]=u.useState(!1),[D,y]=u.useState(null),[d,v]=u.useState(0),$=async()=>{N(!0);try{const[r,j]=await Promise.all([X(),xe()]);g(r);const A=r.map(t=>j.find(m=>m.productId===t.id)||{productId:t.id,stock:0,reserved:0,lowStockThreshold:10,lastUpdated:new Date});i(A);const P={};r.forEach(t=>{const p=[];t.sizes&&t.sizes.length>0&&p.push({id:"size-"+t.id,name:"Talla",values:t.sizes}),t.colors&&t.colors.length>0&&p.push({id:"color-"+t.id,name:"Color",values:t.colors}),P[t.id]=p}),c(P)}catch{}finally{N(!1)}};u.useEffect(()=>{$()},[]);const I=r=>a.find(j=>j.id===r),F=r=>s.find(j=>j.productId===r),B=async(r,j)=>{try{const A=await K(r,j);A&&i(s.map(P=>P.productId===r?A:P)),y(null)}catch{alert("Error al actualizar stock")}},M=r=>{const j=F(r.id);j&&n({product:r,inventory:j})},R=async(r,j,A,P)=>{try{const t=await Z(r.id,r);if(!t)throw new Error("No se pudo guardar el producto");const p=await K(r.id,j.stock);g(a.map(m=>m.id===t.id?t:m)),i(p?s.map(m=>m.productId===r.id?p:m):s.map(m=>m.productId===r.id?j:m)),c({...b,[r.id]:A}),l({...x,[r.id]:P}),n(null),alert("âœ… Producto e inventario guardados exitosamente")}catch(t){alert("âŒ Error: "+(t instanceof Error?t.message:"Error desconocido"))}},_=r=>{const j=r.stock-r.reserved;return j<=0?{label:"Sin Stock",color:"bg-red-100 text-red-800"}:j<=r.lowStockThreshold?{label:"Stock Bajo",color:"bg-yellow-100 text-yellow-800"}:{label:"En Stock",color:"bg-green-100 text-green-800"}},G=r=>{const j=b[r]||[];return j.length===0?0:j.reduce((A,P)=>A*(P.values.length||1),1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-black",children:"GestiÃ³n de Inventario"}),e.jsx(L,{onClick:()=>o(!0),children:"+ Nuevo Producto"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-lg text-sm font-bold",children:["âœ“ ",s.filter(r=>r.stock-r.reserved>r.lowStockThreshold).length," En Stock"]}),e.jsxs("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-lg text-sm font-bold",children:["âš  ",s.filter(r=>r.stock-r.reserved>0&&r.stock-r.reserved<=r.lowStockThreshold).length," Stock Bajo"]}),e.jsxs("span",{className:"px-3 py-1 bg-red-100 text-red-800 rounded-lg text-sm font-bold",children:["âœ• ",s.filter(r=>r.stock-r.reserved<=0).length," Sin Stock"]})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-stone-200 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-stone-50 border-b border-stone-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:h.th,children:"Producto"}),e.jsx("th",{className:h.th,children:"Destacado"}),e.jsx("th",{className:h.th,children:"ImÃ¡genes"}),e.jsx("th",{className:h.th,children:"Variantes"}),e.jsx("th",{className:h.th,children:"Stock Total"}),e.jsx("th",{className:h.th,children:"Reservado"}),e.jsx("th",{className:h.th,children:"Estado"}),e.jsx("th",{className:h.th,children:"Acciones"})]})}),e.jsx("tbody",{children:s.map(r=>{const j=I(r.productId);if(!j)return null;r.stock-r.reserved;const A=_(r),P=G(r.productId);return e.jsxs("tr",{className:"border-b border-stone-100 hover:bg-stone-50",children:[e.jsx("td",{className:h.td,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:j.imageUrl,alt:j.name,className:"w-12 h-12 rounded object-cover"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-black",children:j.name}),e.jsx("p",{className:"text-sm text-stone-600",children:j.category})]})]})}),e.jsx("td",{className:h.td,children:j.isFeatured?e.jsx("span",{className:"text-gold-500 text-lg",title:"Destacado en landing page",children:"â­"}):e.jsx("span",{className:"text-stone-300",title:"No destacado",children:"â˜†"})}),e.jsx("td",{className:h.td,children:j.images&&j.images.length>0?e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-bold",children:["ðŸ–¼ï¸ ",j.images.length]}):e.jsx("span",{className:"text-stone-400 text-xs",children:"1"})}),e.jsx("td",{className:h.td,children:P>0?e.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs font-bold",children:[P," combinaciones"]}):e.jsx("span",{className:"text-stone-400 text-xs",children:"Sin variantes"})}),e.jsx("td",{className:h.td,children:D===r.productId?e.jsx("input",{type:"number",value:d,onChange:t=>v(Number(t.target.value)),className:"w-20 px-2 py-1 border border-gold-500 rounded",autoFocus:!0}):e.jsx("span",{className:"font-bold",children:r.stock})}),e.jsx("td",{className:h.td,children:e.jsx("span",{className:"text-orange-600 font-medium",children:r.reserved})}),e.jsx("td",{className:h.td,children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${A.color}`,children:A.label})}),e.jsx("td",{className:h.td,children:D===r.productId?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>B(r.productId,d),className:"px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600 text-sm font-bold",children:"âœ“"}),e.jsx("button",{onClick:()=>y(null),className:"px-3 py-1 bg-stone-300 text-black rounded hover:bg-stone-400 text-sm font-bold",children:"âœ•"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{y(r.productId),v(r.stock)},className:"px-3 py-1 bg-gold-500 text-black rounded hover:bg-gold-600 text-sm font-bold",title:"EdiciÃ³n rÃ¡pida",children:"ðŸ“¦"}),e.jsx("button",{onClick:()=>M(j),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm font-bold",title:"EdiciÃ³n completa",children:"âœï¸"})]})})]},r.productId)})})]})}),f&&e.jsx(H,{product:f.product,initialInventory:f.inventory,initialVariantTypes:b[f.product.id]||[],initialVariantInventory:x[f.product.id]||[],onSave:R,onClose:()=>n(null)}),k&&e.jsx(H,{product:null,initialInventory:{},initialVariantTypes:[],initialVariantInventory:[],onSave:R,onClose:()=>o(!1)})]})},h={th:"px-4 py-3 text-left text-xs font-bold text-stone-700 uppercase tracking-wider",td:"px-4 py-3 text-sm text-stone-900",label:"block text-sm font-bold text-stone-900 mb-1",input:"w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-gold-500 outline-none"},pe=()=>{const[a,g]=u.useState([]),[w,N]=u.useState(!0),[s,i]=u.useState([]),[b,c]=u.useState(!1),[x,l]=u.useState({productId:"",specialPrice:0,startDate:"",endDate:""});u.useEffect(()=>{(async()=>{try{const v=await X();g(v)}catch{}finally{N(!1)}})()},[]);const f=d=>{d.preventDefault();const v={id:Date.now().toString(),productId:x.productId,specialPrice:x.specialPrice,startDate:new Date(x.startDate),endDate:new Date(x.endDate),isActive:!0,createdAt:new Date};i([...s,v]),c(!1),l({productId:"",specialPrice:0,startDate:"",endDate:""})},n=d=>{confirm("Â¿Seguro que quieres eliminar esta programaciÃ³n?")&&i(s.filter(v=>v.id!==d))},k=d=>{i(s.map(v=>v.id===d?{...v,isActive:!v.isActive}:v))},o=d=>a.find(v=>v.id===d),D=d=>{const v=new Date;return d.isActive&&v>=d.startDate&&v<=d.endDate},y=(d,v)=>Math.round((d-v)/d*100);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-black",children:"ProgramaciÃ³n de Precios"}),e.jsx(L,{onClick:()=>c(!b),children:b?"Cancelar":"+ Nuevo Precio Programado"})]}),b&&e.jsxs("form",{onSubmit:f,className:"bg-white p-6 rounded-xl border-2 border-gold-500 space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:E.label,children:"Producto"}),w?e.jsx("div",{className:"text-stone-500",children:"Cargando productos..."}):e.jsxs("select",{value:x.productId,onChange:d=>l({...x,productId:d.target.value}),required:!0,className:E.input,children:[e.jsx("option",{value:"",children:"Selecciona un producto"}),a.map(d=>e.jsxs("option",{value:d.id,children:[d.name," - ",O(d.price)]},d.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:E.label,children:"Precio Especial (S/)"}),e.jsx("input",{type:"number",value:x.specialPrice,onChange:d=>l({...x,specialPrice:Number(d.target.value)}),min:"0",step:"0.01",required:!0,className:E.input}),x.productId&&x.specialPrice>0&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Descuento: ",y(o(x.productId).price,x.specialPrice),"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:E.label,children:"Fecha y Hora de Inicio"}),e.jsx("input",{type:"datetime-local",value:x.startDate,onChange:d=>l({...x,startDate:d.target.value}),required:!0,className:E.input})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:E.label,children:"Fecha y Hora de Fin"}),e.jsx("input",{type:"datetime-local",value:x.endDate,onChange:d=>l({...x,endDate:d.target.value}),required:!0,className:E.input})]})]}),e.jsx(L,{type:"submit",className:"w-full",children:"Programar Precio"})]}),e.jsx("div",{className:"grid gap-4",children:s.length===0?e.jsx("div",{className:"text-center py-12 bg-stone-50 rounded-xl",children:e.jsx("p",{className:"text-stone-500",children:"No hay precios programados"})}):s.map(d=>{const v=o(d.productId);if(!v)return null;const $=D(d),I=y(v.price,d.specialPrice);return e.jsx("div",{className:`${E.scheduleCard} ${!d.isActive&&"opacity-50"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("img",{src:v.imageUrl,alt:v.name,className:"w-20 h-20 rounded object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-bold text-black text-lg",children:v.name}),$&&e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs font-bold animate-pulse",children:"ðŸ”´ ACTIVO AHORA"}),!d.isActive&&e.jsx("span",{className:"px-2 py-1 bg-stone-100 text-stone-600 rounded text-xs font-bold",children:"Pausado"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-600",children:"Precio Original:"}),e.jsx("p",{className:"text-lg font-bold text-stone-400 line-through",children:O(v.price)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-600",children:"Precio Especial:"}),e.jsx("p",{className:"text-lg font-bold text-gold-700",children:O(d.specialPrice)}),e.jsxs("span",{className:"text-green-600 font-bold",children:["-",I,"% OFF"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-600",children:"Inicia:"}),e.jsx("p",{className:"font-bold",children:new Date(d.startDate).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-600",children:"Termina:"}),e.jsx("p",{className:"font-bold",children:new Date(d.endDate).toLocaleString()})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>k(d.id),className:E.actionButton,title:d.isActive?"Pausar":"Activar",children:d.isActive?"â¸ï¸":"â–¶ï¸"}),e.jsx("button",{onClick:()=>n(d.id),className:`${E.actionButton} hover:bg-red-50`,title:"Eliminar",children:"ðŸ—‘ï¸"})]})]})},d.id)})})]})},E={label:"block text-sm font-bold text-stone-900 mb-1",input:"w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-gold-500 outline-none",scheduleCard:"bg-white p-4 rounded-xl border border-stone-200 hover:shadow-md transition-shadow",actionButton:"p-2 hover:bg-stone-100 rounded-lg transition-colors text-xl"},he=()=>{const[a,g]=u.useState([]),[w,N]=u.useState(!1),[s,i]=u.useState({title:"",message:"",imageUrl:"",ctaText:"",ctaLink:"",startDate:"",endDate:"",showOnce:!1,delaySeconds:0}),b=n=>{n.preventDefault();const k={id:Date.now().toString(),title:s.title,message:s.message,imageUrl:s.imageUrl||void 0,ctaText:s.ctaText||void 0,ctaLink:s.ctaLink||void 0,startDate:new Date(s.startDate),endDate:new Date(s.endDate),displayRules:{showOnce:s.showOnce,delaySeconds:s.delaySeconds||0},isActive:!0,createdAt:new Date};g([...a,k]),N(!1),c()},c=()=>{i({title:"",message:"",imageUrl:"",ctaText:"",ctaLink:"",startDate:"",endDate:"",showOnce:!1,delaySeconds:0})},x=n=>{confirm("Â¿Seguro que quieres eliminar este popup?")&&g(a.filter(k=>k.id!==n))},l=n=>{g(a.map(k=>k.id===n?{...k,isActive:!k.isActive}:k))},f=n=>{const k=new Date;return n.isActive&&k>=n.startDate&&k<=n.endDate};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-black",children:"Popups Promocionales"}),e.jsx(L,{onClick:()=>N(!w),children:w?"Cancelar":"+ Nuevo Popup"})]}),w&&e.jsxs("form",{onSubmit:b,className:"bg-white p-6 rounded-xl border-2 border-gold-500 space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:C.label,children:"TÃ­tulo del Popup"}),e.jsx("input",{type:"text",value:s.title,onChange:n=>i({...s,title:n.target.value}),placeholder:"Â¡Gran Descuento de Verano!",required:!0,className:C.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:C.label,children:"Mensaje"}),e.jsx("textarea",{value:s.message,onChange:n=>i({...s,message:n.target.value}),placeholder:"ObtÃ©n hasta 50% de descuento en productos seleccionados...",required:!0,rows:3,className:C.input})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:C.label,children:"URL de Imagen (Opcional)"}),e.jsx("input",{type:"url",value:s.imageUrl,onChange:n=>i({...s,imageUrl:n.target.value}),placeholder:"https://...",className:C.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:C.label,children:"Texto del BotÃ³n (Opcional)"}),e.jsx("input",{type:"text",value:s.ctaText,onChange:n=>i({...s,ctaText:n.target.value}),placeholder:"Ver Ofertas",className:C.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:C.label,children:"Enlace del BotÃ³n (Opcional)"}),e.jsx("input",{type:"text",value:s.ctaLink,onChange:n=>i({...s,ctaLink:n.target.value}),placeholder:"/shop",className:C.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:C.label,children:"Retraso (segundos)"}),e.jsx("input",{type:"number",value:s.delaySeconds,onChange:n=>i({...s,delaySeconds:Number(n.target.value)}),min:"0",className:C.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:C.label,children:"Fecha de Inicio"}),e.jsx("input",{type:"datetime-local",value:s.startDate,onChange:n=>i({...s,startDate:n.target.value}),required:!0,className:C.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:C.label,children:"Fecha de Fin"}),e.jsx("input",{type:"datetime-local",value:s.endDate,onChange:n=>i({...s,endDate:n.target.value}),required:!0,className:C.input})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.showOnce,onChange:n=>i({...s,showOnce:n.target.checked}),className:"w-4 h-4 accent-gold-500"}),e.jsx("span",{className:"text-sm font-medium text-stone-900",children:"Mostrar solo una vez por usuario"})]})})]}),e.jsx(L,{type:"submit",className:"w-full",children:"Crear Popup"})]}),e.jsx("div",{className:"grid gap-4",children:a.length===0?e.jsx("div",{className:"text-center py-12 bg-stone-50 rounded-xl",children:e.jsx("p",{className:"text-stone-500",children:"No hay popups creados"})}):a.map(n=>{const k=f(n);return e.jsx("div",{className:`${C.popupCard} ${!n.isActive&&"opacity-50"}`,children:e.jsxs("div",{className:"flex gap-4",children:[n.imageUrl&&e.jsx("img",{src:n.imageUrl,alt:n.title,className:"w-32 h-32 rounded object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-bold text-black text-lg",children:n.title}),k&&e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs font-bold animate-pulse",children:"ðŸ”´ MOSTRANDO"}),!n.isActive&&e.jsx("span",{className:"px-2 py-1 bg-stone-100 text-stone-600 rounded text-xs font-bold",children:"Pausado"})]}),e.jsx("p",{className:"text-stone-700 mb-3",children:n.message}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-600",children:"Inicia:"}),e.jsx("p",{className:"font-bold",children:new Date(n.startDate).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-600",children:"Termina:"}),e.jsx("p",{className:"font-bold",children:new Date(n.endDate).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-600",children:"Retraso:"}),e.jsxs("p",{className:"font-bold",children:[n.displayRules.delaySeconds||0,"s"]})]})]}),n.ctaText&&n.ctaLink&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-xs text-stone-600",children:"BotÃ³n: "}),e.jsxs("span",{className:"text-sm font-bold text-gold-700",children:[n.ctaText," â†’ ",n.ctaLink]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>l(n.id),className:C.actionButton,title:n.isActive?"Pausar":"Activar",children:n.isActive?"â¸ï¸":"â–¶ï¸"}),e.jsx("button",{onClick:()=>x(n.id),className:`${C.actionButton} hover:bg-red-50`,title:"Eliminar",children:"ðŸ—‘ï¸"})]})]})},n.id)})})]})},C={label:"block text-sm font-bold text-stone-900 mb-1",input:"w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-gold-500 outline-none",popupCard:"bg-white p-4 rounded-xl border border-stone-200 hover:shadow-md transition-shadow",actionButton:"p-2 hover:bg-stone-100 rounded-lg transition-colors text-xl"},z={pending:{label:"Pendiente",color:"bg-yellow-100 text-yellow-800",icon:"â³"},confirmed:{label:"Confirmado",color:"bg-blue-100 text-blue-800",icon:"âœ“"},processing:{label:"Preparando",color:"bg-purple-100 text-purple-800",icon:"ðŸ“¦"},shipped:{label:"Enviado",color:"bg-indigo-100 text-indigo-800",icon:"ðŸšš"},delivered:{label:"Entregado",color:"bg-green-100 text-green-800",icon:"âœ…"},cancelled:{label:"Cancelado",color:"bg-red-100 text-red-800",icon:"âŒ"}},ge=()=>{const[a,g]=u.useState([]),[w,N]=u.useState(!0),[s,i]=u.useState(null),[b,c]=u.useState("all");u.useEffect(()=>{x()},[]);const x=async()=>{try{const o=await Y();g(o)}catch{}finally{N(!1)}},l=b==="all"?a:a.filter(o=>o.status===b),f=async(o,D)=>{try{await ee(o,D),g(a.map(y=>y.id===o?{...y,status:D,updatedAt:new Date}:y)),s?.id===o&&i({...s,status:D,updatedAt:new Date})}catch{alert("Error al actualizar el estado del pedido")}},k={pending:a.filter(o=>o.status==="pending").length,processing:a.filter(o=>o.status==="processing"||o.status==="confirmed").length,shipped:a.filter(o=>o.status==="shipped").length,delivered:a.filter(o=>o.status==="delivered").length};return w?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-gold-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-stone-600",children:"Cargando pedidos..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-black",children:"GestiÃ³n de Pedidos"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-lg text-sm font-bold",children:["â³ ",k.pending," Pendientes"]}),e.jsxs("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-lg text-sm font-bold",children:["ðŸ“¦ ",k.processing," Preparando"]}),e.jsxs("span",{className:"px-3 py-1 bg-indigo-100 text-indigo-800 rounded-lg text-sm font-bold",children:["ðŸšš ",k.shipped," Enviados"]})]})]}),e.jsx("div",{className:"flex gap-2 border-b border-stone-200 pb-4",children:["all","pending","confirmed","processing","shipped","delivered","cancelled"].map(o=>e.jsx("button",{onClick:()=>c(o),className:`px-4 py-2 rounded-lg font-bold text-sm transition-colors ${b===o?"bg-gold-500 text-black":"bg-stone-100 text-stone-600 hover:bg-stone-200"}`,children:o==="all"?"Todos":z[o].label},o))}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-4",children:l.map(o=>e.jsxs("div",{onClick:()=>i(o),className:`bg-white rounded-xl p-4 border-2 cursor-pointer transition-all hover:shadow-lg ${s?.id===o.id?"border-gold-500 shadow-gold":"border-stone-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-black",children:o.id}),e.jsxs("p",{className:"text-sm text-stone-500",children:[o.shippingAddress.firstName," ",o.shippingAddress.lastName]})]}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${z[o.status].color}`,children:[z[o.status].icon," ",z[o.status].label]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.items.slice(0,3).map((D,y)=>e.jsx("img",{src:D.productImage,alt:"",className:"w-10 h-10 rounded object-cover"},y)),o.items.length>3&&e.jsxs("span",{className:"w-10 h-10 bg-stone-100 rounded flex items-center justify-center text-xs font-bold text-stone-600",children:["+",o.items.length-3]}),e.jsx("span",{className:"ml-auto font-bold text-gold-600",children:O(o.total)})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-stone-500",children:[e.jsx("span",{children:o.createdAt.toLocaleDateString("es-PE")}),e.jsxs("span",{children:[o.items.reduce((D,y)=>D+y.quantity,0)," productos"]})]})]},o.id))}),e.jsx("div",{className:"bg-white rounded-xl border border-stone-200 p-6 h-fit sticky top-24",children:s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-black",children:s.id}),e.jsx("button",{onClick:()=>i(null),className:"text-stone-400 hover:text-black",children:"âœ•"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-stone-700 mb-2",children:"Estado del Pedido"}),e.jsxs("select",{value:s.status,onChange:o=>f(s.id,o.target.value),className:"w-full px-4 py-2 border border-stone-300 rounded-lg font-bold",children:[e.jsx("option",{value:"pending",children:"â³ Pendiente"}),e.jsx("option",{value:"confirmed",children:"âœ“ Confirmado"}),e.jsx("option",{value:"processing",children:"ðŸ“¦ Preparando"}),e.jsx("option",{value:"shipped",children:"ðŸšš Enviado"}),e.jsx("option",{value:"delivered",children:"âœ… Entregado"}),e.jsx("option",{value:"cancelled",children:"âŒ Cancelado"})]})]}),e.jsxs("div",{className:"border-t border-stone-200 pt-4",children:[e.jsx("h4",{className:"font-bold text-black mb-2",children:"Cliente"}),e.jsxs("p",{className:"text-sm text-stone-700",children:[s.shippingAddress.firstName," ",s.shippingAddress.lastName]}),e.jsx("p",{className:"text-sm text-stone-500",children:s.shippingAddress.email}),e.jsx("p",{className:"text-sm text-stone-500",children:s.shippingAddress.phone})]}),e.jsxs("div",{className:"border-t border-stone-200 pt-4",children:[e.jsx("h4",{className:"font-bold text-black mb-2",children:"DirecciÃ³n de EnvÃ­o"}),e.jsx("p",{className:"text-sm text-stone-700",children:s.shippingAddress.address}),e.jsxs("p",{className:"text-sm text-stone-500",children:[s.shippingAddress.district,", ",s.shippingAddress.city]})]}),e.jsxs("div",{className:"border-t border-stone-200 pt-4",children:[e.jsx("h4",{className:"font-bold text-black mb-2",children:"Productos"}),e.jsx("div",{className:"space-y-2",children:s.items.map((o,D)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:o.productImage,alt:"",className:"w-12 h-12 rounded object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-black",children:o.productName}),e.jsxs("p",{className:"text-xs text-stone-500",children:["Cant: ",o.quantity]})]}),e.jsx("p",{className:"font-bold text-gold-600",children:O(o.price*o.quantity)})]},D))})]}),e.jsxs("div",{className:"border-t border-stone-200 pt-4 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:O(s.subtotal)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"EnvÃ­o"}),e.jsx("span",{children:s.shipping===0?"GRATIS":O(s.shipping)})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg border-t pt-2",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"text-gold-600",children:O(s.total)})]})]})]}):e.jsxs("div",{className:"text-center text-stone-500 py-10",children:[e.jsx("p",{className:"text-4xl mb-4",children:"ðŸ“‹"}),e.jsx("p",{children:"Selecciona un pedido para ver los detalles"})]})})]})]})},be=({orders:a,users:g,isLoading:w})=>{const N=u.useMemo(()=>{const i=a.reduce((l,f)=>l+(f.total||0),0),b=a.length,c=g.length,x=b>0?i/b:0;return{totalEarnings:i,totalOrders:b,totalCustomers:c,averageTicket:x}},[a,g]),s=u.useMemo(()=>Array.from({length:7},(b,c)=>{const x=new Date;return x.setDate(x.getDate()-c),x.toISOString().split("T")[0]}).reverse().map(b=>{const x=a.filter(l=>l.createdAt.toISOString().split("T")[0]===b).reduce((l,f)=>l+(f.total||0),0);return{name:new Date(b).toLocaleDateString("es-ES",{weekday:"short"}),ventas:x}}),[a]);return w?e.jsx("div",{className:"p-8 text-center",children:"Cargando estadÃ­sticas..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border-l-4 border-gold-500",children:[e.jsx("p",{className:"text-stone-500 text-sm font-bold uppercase",children:"Ingresos Totales"}),e.jsx("p",{className:"text-2xl font-bold text-black",children:O(N.totalEarnings)})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-stone-500 text-sm font-bold uppercase",children:"Pedidos"}),e.jsx("p",{className:"text-2xl font-bold text-black",children:N.totalOrders})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border-l-4 border-green-500",children:[e.jsx("p",{className:"text-stone-500 text-sm font-bold uppercase",children:"Clientes"}),e.jsx("p",{className:"text-2xl font-bold text-black",children:N.totalCustomers})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border-l-4 border-purple-500",children:[e.jsx("p",{className:"text-stone-500 text-sm font-bold uppercase",children:"Ticket Promedio"}),e.jsx("p",{className:"text-2xl font-bold text-black",children:O(N.averageTicket)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-lg font-bold text-black mb-4",children:"Ventas de la Semana"}),e.jsx("div",{className:"h-64",children:e.jsx(te,{width:"100%",height:"100%",children:e.jsxs(ae,{data:s,children:[e.jsx(le,{strokeDasharray:"3 3",vertical:!1}),e.jsx(ne,{dataKey:"name",axisLine:!1,tickLine:!1}),e.jsx(re,{axisLine:!1,tickLine:!1,tickFormatter:i=>`S/.${i}`}),e.jsx(ie,{formatter:i=>[O(i),"Ventas"],contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(oe,{dataKey:"ventas",fill:"#EAB308",radius:[4,4,0,0],children:s.map((i,b)=>e.jsx(ce,{fill:b===s.length-1?"#CA8A04":"#EAB308"},`cell-${b}`))})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-lg font-bold text-black mb-4",children:"Ãšltimos Clientes"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-stone-50 text-stone-600 text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Cliente"}),e.jsx("th",{className:"p-3",children:"Email"}),e.jsx("th",{className:"p-3",children:"TelÃ©fono"})]})}),e.jsxs("tbody",{className:"divide-y divide-stone-100",children:[g.slice(0,5).map((i,b)=>e.jsxs("tr",{className:"hover:bg-stone-50",children:[e.jsx("td",{className:"p-3 font-medium",children:i.firstName?`${i.firstName} ${i.lastName}`:"Usuario sin nombre"}),e.jsx("td",{className:"p-3 text-stone-600",children:i.email}),e.jsx("td",{className:"p-3 text-stone-500",children:i.phone||"-"})]},b)),g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"p-4 text-center text-stone-500",children:"No hay clientes registrados"})})]})]})})]})]})},ke=()=>{const[a,g]=u.useState("dashboard"),[w,N]=u.useState({orders:[],users:[]}),[s,i]=u.useState(!1);u.useEffect(()=>{(async()=>{if(a==="dashboard"){i(!0);try{const[x,l]=await Promise.all([Y(),se()]);N({orders:x,users:l})}catch{}finally{i(!1)}}})()},[a]);const b=[{id:"dashboard",label:"Dashboard",icon:"ðŸ“Š"},{id:"orders",label:"Pedidos",icon:"ðŸ“‹"},{id:"inventory",label:"Inventario",icon:"ðŸ“¦"},{id:"coupons",label:"Cupones",icon:"ðŸŽŸï¸"},{id:"pricing",label:"Precios",icon:"ðŸ’°"},{id:"popups",label:"Popups",icon:"ðŸŽª"}];return e.jsxs("div",{className:U.layout,children:[e.jsx("h1",{className:U.pageTitle,children:"Panel de AdministraciÃ³n"}),e.jsx("div",{className:U.tabContainer,children:b.map(c=>e.jsxs("button",{onClick:()=>g(c.id),className:`${U.tab} ${a===c.id?U.tabActive:U.tabInactive}`,children:[e.jsx("span",{className:"text-xl",children:c.icon}),e.jsx("span",{children:c.label})]},c.id))}),e.jsxs("div",{className:U.content,children:[a==="dashboard"&&e.jsx(be,{orders:w.orders,users:w.users,isLoading:s}),a==="orders"&&e.jsx(ge,{}),a==="inventory"&&e.jsx(ue,{}),a==="coupons"&&e.jsx(de,{}),a==="pricing"&&e.jsx(pe,{}),a==="popups"&&e.jsx(he,{})]})]})},U={layout:"max-w-7xl mx-auto p-6",pageTitle:"text-3xl font-bold text-black mb-6",tabContainer:"flex gap-2 mb-6 border-b border-stone-200 overflow-x-auto",tab:"flex items-center gap-2 px-4 py-3 font-bold whitespace-nowrap transition-colors",tabActive:"border-b-2 border-gold-600 text-gold-700",tabInactive:"text-stone-600 hover:text-black",content:"mt-6"};export{ke as default};
